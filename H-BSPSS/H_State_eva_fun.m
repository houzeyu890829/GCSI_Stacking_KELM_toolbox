function State=H_State_eva_fun(S,Q,Initial_output,ob,p)
K=ES_model(S);
M=Initial_output;
MAX_ob=[12.0998833,14.61980668,14.99289821,11.47979193,12.71148979,13.1885,9.626355829,11.57017591,12.12795358,14.66102934,15.01233528,11.50799963,12.7525215,13.20717483,9.66046274,11.62675944,12.13825225,14.67451257,15.01859636,11.51673665,12.76517983,13.21306648,9.671459244,11.63480797,9.16377551,9.115816327,9.259693878,8.94744898,8.798469388,8.798469388,8.538265306,8.501530612];
MIN_ob=[-7.107128465,1.860853375,4.071908253,-8.757321338,-2.065936778,1.095055099,-13.56395854,-3.067273225,-6.83951959,2.043748802,4.244255209,-8.506997984,-1.89423177,1.260659158,-13.14332957,-2.759048082,-6.750778492,2.106212889,4.29795461,-8.433461739,-1.841827884,1.309746283,-13.062777,-2.712299823,8.532142857,8.509693878,8.576020408,8.433163265,8.364795918,8.364795918,8.246428571,8.229081633];

for i=1:32
   K(i)=K(i)*(MAX_ob(i)-MIN_ob(i))+MIN_ob(i);
   M(i)=M(i)*(MAX_ob(i)-MIN_ob(i))+MIN_ob(i);
   ob(i)=ob(i)*(MAX_ob(i)-MIN_ob(i))+MIN_ob(i);
end

f=0;
for i=1:24
f=f+(K(1,i)-(p*ob(i)+(1-p)*M(i))).^2;
end

g=0;
for i=25:32
g=g+(K(1,i)-(p*ob(i)+(1-p)*M(i))).^2;
end

likelihood=(1/(((2*pi).^12)*0.6.^24)*exp(-0.5*f/0.36))*(1/(((2*pi).^4)*0.03.^8)*exp(-0.5*g/0.0009));
% likelihood=(1/(((2*pi).^12)*1.5.^24)*exp(-0.5*f/2.25))*(1/(((2*pi).^4)*0.03.^8)*exp(-0.5*g/0.0009));
MAX=[599.6950677,219.5777216,0.27909677,0.299583466,900,0.340997326,0.3980923,0.560995418,37825.50072,8729.800881,153.9357473,70.70937087,18.40917255,130.2283353,0.307632345,0.360747515];
MIN=[440.5066384,60.70025821,0.080214354,0.100684851,600,0.280339587,0.331335197,0.440728567,31652.47927,7426.343354,46.58612812,48.91585912,11.68017118,114.5540089,0.171740346,0.05408236];
for i=1:16
   Q(i)=Q(i)*(MAX(i)-MIN(i))+MIN(i);
end
% PDF1=1/(MAX(1)-MIN(1));
% PDF2=1/(MAX(2)-MIN(2));
% PDF3=1/(MAX(3)-MIN(3));
% PDF4=1/(MAX(4)-MIN(4));
% PDF5=1/(MAX(5)-MIN(5));
PDF1=100/(((2*pi).^0.5)*(3200*0.25).^0.5)*exp(-0.5*(S(1)*(MAX(1)-MIN(1))+MIN(1)-Q(1)).^2/(3200*0.25));
PDF2=100/(((2*pi).^0.5)*(3200*0.25).^0.5)*exp(-0.5*(S(2)*(MAX(2)-MIN(2))+MIN(2)-Q(2)).^2/(3200*0.25));
PDF3=100/(((2*pi).^0.5)*(0.0025*0.25).^0.5)*exp(-0.5*(S(3)*(MAX(3)-MIN(3))+MIN(3)-Q(3)).^2/(0.0025*0.25));
PDF4=100/(((2*pi).^0.5)*(0.003*0.25).^0.5)*exp(-0.5*(S(4)*(MAX(4)-MIN(4))+MIN(4)-Q(4)).^2/(0.003*0.25));
PDF5=100/(((2*pi).^0.5)*(5500*0.25).^0.5)*exp(-0.5*(S(5)*(MAX(5)-MIN(5))+MIN(5)-Q(5)).^2/(5500*0.25));
PDF6=100/(((2*pi).^0.5)*(0.002*0.25).^0.5)*exp(-0.5*(S(6)*(MAX(6)-MIN(6))+MIN(6)-Q(6)).^2/(0.002*0.25));
PDF7=100/(((2*pi).^0.5)*(0.002*0.25).^0.5)*exp(-0.5*(S(7)*(MAX(7)-MIN(7))+MIN(7)-Q(7)).^2/(0.002*0.25));
PDF8=100/(((2*pi).^0.5)*(0.002*0.25).^0.5)*exp(-0.5*(S(8)*(MAX(8)-MIN(8))+MIN(8)-Q(8)).^2/(0.002*0.25));
PDF9=100/(((2*pi).^0.5)*(35000*0.25).^0.5)*exp(-0.5*(S(9)*(MAX(9)-MIN(9))+MIN(9)-Q(9)).^2/(35000*0.25));
PDF10=100/(((2*pi).^0.5)*(40000*0.25).^0.5)*exp(-0.5*(S(10)*(MAX(10)-MIN(10))+MIN(10)-Q(10)).^2/(40000*0.25));
PDF11=100/(((2*pi).^0.5)*(400*0.25).^0.5)*exp(-0.5*(S(11)*(MAX(11)-MIN(11))+MIN(11)-Q(11)).^2/(400*0.25));
PDF12=100/(((2*pi).^0.5)*(40*0.25).^0.5)*exp(-0.5*(S(12)*(MAX(12)-MIN(12))+MIN(12)-Q(12)).^2/(40*0.25));
PDF13=100/(((2*pi).^0.5)*(5*0.25).^0.5)*exp(-0.5*(S(13)*(MAX(13)-MIN(13))+MIN(13)-Q(13)).^2/(5*0.25));
PDF14=100/(((2*pi).^0.5)*(1*0.25).^0.5)*exp(-0.5*((S(14)*(MAX(14)-MIN(14))+MIN(14)-Q(14))/10.1325/650*1000).^2/(1*0.25));
PDF15=100/(((2*pi).^0.5)*(0.002*0.25).^0.5)*exp(-0.5*(S(15)*(MAX(15)-MIN(15))+MIN(15)-Q(15)).^2/(0.002*0.25));
PDF16=100/(((2*pi).^0.5)*(0.005*0.25).^0.5)*exp(-0.5*(S(16)*(MAX(16)-MIN(16))+MIN(16)-Q(16)).^2/(0.005*0.25));
State=likelihood*PDF1*PDF2*PDF3*PDF4*PDF5*PDF6*PDF7*PDF8*PDF9*PDF10*PDF11*PDF12*PDF13*PDF14*PDF15*PDF16;
% State=likelihood;
State=1/State;
end